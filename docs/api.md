# API 设计规范

## 1. HTTP 方法规范

1. 只允许使用以下 HTTP 方法：

   - GET：获取资源
   - POST：创建/更新/删除资源
   - OPTIONS：预检请求

2. 资源操作规范：

   - 新建操作：POST /resources
   - 查询操作：GET /resources/{id}
   - 更新操作：POST /resources/{id}/update
   - 删除操作：POST /resources/{id}/delete

3. 禁止使用的方法：
   - PUT
   - PATCH
   - DELETE

## 2. 基础规范

### 2.1 基础信息

- 基础路径：`/api/v1`
- 认证方式：JWT Token
- 响应格式：JSON
- 时间格式：ISO 8601

### 2.2 请求规范

1. 请求头：

   - `Authorization: Bearer <token>`
   - `Content-Type: application/json`

2. 查询参数：
   - 分页参数：`page`（默认：1）和 `size`（默认：20）
   - 时间参数：使用 ISO 8601 格式
   - 布尔值：使用 `true`/`false`

### 2.3 响应规范

成功响应：

```json
{
  "code": 0,
  "message": "success",
  "data": {},
  "trace_id": "xxx"
}
```

错误响应：

```json
{
  "code": "错误码",
  "message": "错误信息",
  "details": {}
}
```

### 2.4 错误码规范

- 400：请求参数错误
- 401：未认证
- 403：权限不足
- 404：资源不存在
- 409：资源冲突
- 500：服务器内部错误

## 3. 安全规范

### 3.1 认证

- 所有接口必须认证
- 支持 JWT Token 认证
- Token 过期机制

### 3.2 授权

- 基于角色的访问控制
- 细粒度的权限控制
- 资源访问控制

### 3.3 数据安全

- 敏感数据加密传输
- 防止 SQL 注入
- 防止 XSS 攻击
- 防止 CSRF 攻击

## 4. 性能规范

### 4.1 缓存策略

- 合理使用 HTTP 缓存
- 支持服务端缓存
- 缓存失效策略

### 4.2 限流策略

- 接口访问频率限制
- IP 访问限制
- 用户访问限制

### 4.3 响应时间

- 接口响应时间限制
- 超时处理机制
- 重试策略

## 5. 版本控制

### 5.1 版本策略

- URL 路径版本控制
- 向后兼容性保证
- 版本废弃策略

### 5.2 文档维护

- 及时更新接口文档
- 记录接口变更历史
- 提供接口示例
